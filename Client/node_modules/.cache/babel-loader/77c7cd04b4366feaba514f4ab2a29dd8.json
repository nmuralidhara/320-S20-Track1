{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Sean\\\\320-S20-Track1\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Button from\"@material-ui/core/Button\";import CssBaseline from\"@material-ui/core/CssBaseline\";import TextField from\"@material-ui/core/TextField\";import{FormHelperText,FormControl}from\"@material-ui/core\";import Link from\"@material-ui/core/Link\";import Grid from\"@material-ui/core/Grid\";import Box from\"@material-ui/core/Box\";import Typography from\"@material-ui/core/Typography\";import{makeStyles}from\"@material-ui/core/styles\";import Container from\"@material-ui/core/Container\";import users from\"../Data/users.json\";import Cookies from\"universal-cookie\";function Copyright(){return/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",color:\"textSecondary\",align:\"center\"},\"Copyright © \",/*#__PURE__*/React.createElement(Link,{color:\"inherit\",href:\"https://github.com/david-fisher/320-S20-Track1/\"},\"King Codras\"),\" \",new Date().getFullYear(),\".\");}var useStyles=makeStyles(function(theme){return{paper:{marginTop:theme.spacing(8),display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},error:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.secondary.main},form:{width:\"100%\",// Fix IE 11 issue.\nmarginTop:theme.spacing(1)},submit:{margin:theme.spacing(3,0,2)}};});export default function SignUp(){var classes=useStyles();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password2=_useState6[0],setPassword2=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),fname=_useState8[0],setFname=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),lname=_useState10[0],setLname=_useState10[1];//to encrypt the password and token\nvar bcrypt=require('bcryptjs');var salt=bcrypt.genSaltSync(10);var saltE=bcrypt.genSaltSync(10);function validateForm(){return password===password2&&email.length>0&&password.length>0&&password2.length>0&&fname.length>0&&lname.length>0&&validEmail(email);}function samePass(pass,pass2){return password===password2;}function validEmail(address){return!!address.match(/.+@.+/);}function handleSubmit(event){var hash=password;event.preventDefault();//POST the user info to the database\nfetch(\"https://7jdf878rej.execute-api.us-east-2.amazonaws.com/test/register/students\",{method:\"POST\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({first_name:fname,last_name:lname,email:email,hashed_password:hash})})//not sure why this is needed but it is\n.then(function(response){console.log(response);return response.json();})//if the status code is good, set the cookies and authenicate\n.then(function(json){console.log(json.statusCode);console.log(json);if(json.statusCode>=200&&json.statusCode<300){alert(\"Account Successfully Created!\");//cookie gets set to 30 minutes\nvar timestamp=new Date().getTime();var expire=timestamp+60*30*1000;var expireDate=new Date(expire);//Sets all of the appropriate cookies\nvar cookies=new Cookies();cookies.remove(\"email\");cookies.remove(\"firstName\");cookies.remove(\"lastName\");cookies.remove(\"role\");cookies.remove(\"token\");cookies.set(\"email\",email,{path:\"/\",expires:expireDate});cookies.set(\"firstName\",fname,{path:\"/\",expires:expireDate});cookies.set(\"lastName\",lname,{path:\"/\",expires:expireDate});cookies.set(\"role\",\"Student\",{path:\"/\",expires:expireDate});cookies.set(\"token\",bcrypt.hashSync(email,saltE),{path:\"/\",expires:expireDate});//reloads the window now that they are authenticated \nwindow.location.reload();}else{throw new Error();}}).catch(function(error){alert(\"There is already a user with that email address. Please try again!\");});}function handleKeyPress(event){if(event.key==='Enter'){handleSubmit(event);}}return/*#__PURE__*/React.createElement(Container,{component:\"main\",maxWidth:\"xs\"},/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(\"div\",{className:classes.paper},/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h5\"},\"Create a student account\"),/*#__PURE__*/React.createElement(\"form\",{className:classes.form,noValidate:true},/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"fname\",label:\"First Name\",name:\"fname\",autoComplete:\"fname\",autoFocus:true,onChange:function onChange(e){return setFname(e.target.value);}}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"lname\",label:\"Last Name\",name:\"lname\",autoComplete:\"lname\",onChange:function onChange(e){return setLname(e.target.value);}}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"Email Address\",name:\"email\",autoComplete:\"email\",onChange:function onChange(e){return setEmail(e.target.value);}}),!validEmail(email)&&email.length>0&&/*#__PURE__*/React.createElement(FormControl,{className:classes.error,error:true},/*#__PURE__*/React.createElement(FormHelperText,null,\"Please enter a valid email\")),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",autoComplete:\"current-password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,name:\"confirm password\",label:\"Confirm Password\",type:\"password\",id:\"Confirmpassword\",autoComplete:\"current-password\",onChange:function onChange(e){return setPassword2(e.target.value);},onKeyPress:handleKeyPress}),!samePass(password,password2)&&password.length>0&&password2.length>0&&/*#__PURE__*/React.createElement(FormControl,{className:classes.error,error:true},/*#__PURE__*/React.createElement(FormHelperText,null,\"Passwords do not match\")),/*#__PURE__*/React.createElement(Typography,{align:\"center\",variant:\"body2\"},\"By requesing an account you agree to ReachOut's\"),/*#__PURE__*/React.createElement(Grid,{container:true,align:\"center\"},/*#__PURE__*/React.createElement(Grid,{item:true,xs:true},/*#__PURE__*/React.createElement(Link,{href:\"/tos\",variant:\"body2\",justify:\"center\"},\"Terms and Condtitions\"))),/*#__PURE__*/React.createElement(Button,{fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,onClick:handleSubmit,disabled:!validateForm()},\"Create Account\"),/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:true},/*#__PURE__*/React.createElement(Link,{href:\"/login\",variant:\"body2\"},\"Back to sign in\")),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Link,{href:\"/signup-supporter\",variant:\"body2\"},\"Want to request a supporter account? Sign Up\"))))),/*#__PURE__*/React.createElement(Box,{mt:8},/*#__PURE__*/React.createElement(Copyright,null)));}","map":{"version":3,"sources":["C:/Users/Sean/320-S20-Track1/src/components/Pages/signup.js"],"names":["React","useState","Button","CssBaseline","TextField","FormHelperText","FormControl","Link","Grid","Box","Typography","makeStyles","Container","users","Cookies","Copyright","Date","getFullYear","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","error","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","SignUp","classes","email","setEmail","password","setPassword","password2","setPassword2","fname","setFname","lname","setLname","bcrypt","require","salt","genSaltSync","saltE","validateForm","length","validEmail","samePass","pass","pass2","address","match","handleSubmit","event","hash","preventDefault","fetch","method","headers","Accept","body","JSON","stringify","first_name","last_name","hashed_password","then","response","console","log","json","statusCode","alert","timestamp","getTime","expire","expireDate","cookies","remove","set","path","expires","hashSync","window","location","reload","Error","catch","handleKeyPress","key","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {FormHelperText, FormControl} from \"@material-ui/core\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport users from \"../Data/users.json\"\r\nimport Cookies from \"universal-cookie\";\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Copyright © \"}\r\n      <Link\r\n        color=\"inherit\"\r\n        href=\"https://github.com/david-fisher/320-S20-Track1/\"\r\n      >\r\n        King Codras\r\n      </Link>{\" \"}\r\n      {new Date().getFullYear()}\r\n      {\".\"}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\"\r\n  },\r\n  error: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\"\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main\r\n  },\r\n  form: {\r\n    width: \"100%\", // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2)\r\n  }\r\n}));\r\n\r\nexport default function SignUp() {\r\n\r\n  const classes = useStyles();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [password2, setPassword2] = useState(\"\");\r\n  const [fname, setFname] = useState(\"\");\r\n  const [lname, setLname] = useState(\"\");\r\n\r\n  //to encrypt the password and token\r\n  var bcrypt = require('bcryptjs');\r\n  var salt = bcrypt.genSaltSync(10);\r\n  var saltE = bcrypt.genSaltSync(10);\r\n\r\n  function validateForm() {\r\n    return password===password2 && email.length > 0 \r\n    && password.length > 0 && password2.length > 0 \r\n    && fname.length > 0 && lname.length > 0\r\n    && validEmail(email);\r\n  }\r\n\r\n  function samePass(pass, pass2){\r\n    return password===password2;\r\n  }\r\n\r\n  function validEmail(address) {\r\n    return !! address.match(/.+@.+/);\r\n  }\r\n\r\n  function handleSubmit(event) {\r\n    var hash=password\r\n\r\n    event.preventDefault();\r\n\r\n    //POST the user info to the database\r\n    fetch(\r\n      \"https://7jdf878rej.execute-api.us-east-2.amazonaws.com/test/register/students\",\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify({\r\n          first_name: fname,\r\n          last_name: lname,\r\n          email: email,\r\n          hashed_password: hash\r\n        })\r\n      }\r\n    )\r\n    //not sure why this is needed but it is\r\n      .then(function(response) {\r\n        console.log(response);\r\n        return response.json();\r\n      })\r\n\r\n      //if the status code is good, set the cookies and authenicate\r\n      .then(json => {\r\n          console.log(json.statusCode);\r\n\r\n          console.log(json);\r\n\r\n          if (json.statusCode >= 200 && json.statusCode < 300) {\r\n            alert(\"Account Successfully Created!\");\r\n\r\n          //cookie gets set to 30 minutes\r\n          const timestamp = new Date().getTime();\r\n          const expire = timestamp + (60 * 30 * 1000);\r\n          const expireDate = new Date(expire);\r\n\r\n          //Sets all of the appropriate cookies\r\n          const cookies = new Cookies();\r\n          cookies.remove(\"email\");\r\n          cookies.remove(\"firstName\");\r\n          cookies.remove(\"lastName\");\r\n          cookies.remove(\"role\");\r\n          cookies.remove(\"token\");\r\n          cookies.set(\"email\", email, {\r\n            path: \"/\",\r\n            expires: expireDate\r\n          });\r\n          cookies.set(\"firstName\", fname, {\r\n            path: \"/\",\r\n            expires: expireDate\r\n          });\r\n          cookies.set(\"lastName\", lname, {\r\n            path: \"/\",\r\n            expires: expireDate\r\n          });\r\n          cookies.set(\"role\", \"Student\", { \r\n            path: \"/\" ,\r\n            expires: expireDate\r\n          });\r\n          cookies.set(\"token\", bcrypt.hashSync(email, saltE) , { \r\n            path: \"/\" ,\r\n            expires: expireDate\r\n          });\r\n\r\n          //reloads the window now that they are authenticated \r\n          window.location.reload();\r\n          } else {\r\n            throw new Error();\r\n          }\r\n       })\r\n      .catch(error => {\r\n        alert(\"There is already a user with that email address. Please try again!\");\r\n      });\r\n  }\r\n\r\n  function handleKeyPress(event){\r\n    if(event.key === 'Enter'){\r\n      handleSubmit(event)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Create a student account\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"fname\"\r\n            label=\"First Name\"\r\n            name=\"fname\"\r\n            autoComplete=\"fname\"\r\n            autoFocus\r\n            onChange={e => setFname(e.target.value)}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"lname\"\r\n            label=\"Last Name\"\r\n            name=\"lname\"\r\n            autoComplete=\"lname\"\r\n            onChange={e => setLname(e.target.value)}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"email\"\r\n            label=\"Email Address\"\r\n            name=\"email\"\r\n            autoComplete=\"email\"\r\n            onChange={e => setEmail(e.target.value)}\r\n          />\r\n          {!validEmail(email) && email.length > 0 && (\r\n            <FormControl className={classes.error} error>\r\n              <FormHelperText>\r\n                Please enter a valid email\r\n              </FormHelperText>\r\n            </FormControl>\r\n          )}\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name=\"password\"\r\n            label=\"Password\"\r\n            type=\"password\"\r\n            id=\"password\"\r\n            autoComplete=\"current-password\"\r\n            onChange={e => setPassword(e.target.value)}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name=\"confirm password\"\r\n            label=\"Confirm Password\"\r\n            type=\"password\"\r\n            id=\"Confirmpassword\"\r\n            autoComplete=\"current-password\"\r\n            onChange={e => setPassword2(e.target.value)}\r\n            onKeyPress={handleKeyPress}\r\n          />\r\n          {!samePass(password, password2) && password.length > 0 && password2.length > 0 && (\r\n            <FormControl className={classes.error} error>\r\n              <FormHelperText>\r\n                Passwords do not match\r\n              </FormHelperText>\r\n            </FormControl>\r\n          )}\r\n          <Typography align=\"center\" variant=\"body2\">\r\n            By requesing an account you agree to ReachOut's\r\n          </Typography>\r\n          <Grid container align=\"center\">\r\n            <Grid item xs>\r\n              <Link href=\"/tos\" variant=\"body2\" justify=\"center\">\r\n                Terms and Condtitions\r\n              </Link>\r\n            </Grid>\r\n          </Grid>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n            onClick={handleSubmit}\r\n            disabled={!validateForm()}\r\n          >\r\n            Create Account\r\n          </Button>\r\n          <Grid container>\r\n            <Grid item xs>\r\n              <Link href=\"/login\" variant=\"body2\">\r\n                Back to sign in\r\n              </Link>\r\n            </Grid>\r\n            <Grid item>\r\n              <Link href=\"/signup-supporter\" variant=\"body2\">\r\n                Want to request a supporter account? Sign Up\r\n              </Link>\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}